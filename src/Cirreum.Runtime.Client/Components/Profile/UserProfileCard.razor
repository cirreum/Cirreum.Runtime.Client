@namespace Cirreum.Components.Profile

<div class="user-profile">
	@if (HasProfileUrl) {
		<div style="display:inline;">
			<a href="@ProfileUrl" target="_blank" title="your account page..." class="btn btn-link btn-sm float-end">
				<i class="bi bi-gear-fill"></i>
			</a>
		</div>
	}
	<div class="hstack gap-3 p-3" style="margin:-8px 0;">
		<div class="pic">
			<div class="profile-pic" aria-hidden="true" role="presentation" style="@ProfilePicStyle"></div>
		</div>
		<div class="vstack">
			<span class="name">@Name</span>
			@if (Company.HasValue()) {
				<span class="company">
					@Company @(JobTitle.HasValue() ? $"({JobTitle})" : "")
				</span>
			}
			@if (Email.HasValue()) {
				<span class="email">@Email</span>
			}
			@if (Status is not null) {
				<div class="presence">
					<span style="@PresenceColorStyle">
						<i class="bi bi-check-circle-fill" aria-hidden="true"></i>
						@(StatusTitle ?? Status.ToString())
					</span>
				</div>
			}
		</div>
	</div>
</div>

@code {

	/// <summary>
	/// The user's Human name.
	/// </summary>
	[Parameter]
	public string Name { get; set; } = "";

	[Parameter]
	public string Email { get; set; } = "";

	[Parameter]
	public string? Company { get; set; }

	[Parameter]
	public string? JobTitle { get; set; }

	[Parameter]
	public PresenceStatus? Status { get; set; }

	[Parameter]
	public string? StatusTitle { get; set; }

	/// <summary>
	/// The url or path to the users profile picture to be displayed
	/// </summary>
	[Parameter]
	public string? ProfilePicUrl { get; set; }

	/// <summary>
	/// The url to navigate to the user's profile page
	/// </summary>
	/// <remarks>
	/// When provided, a Gear icon will be included to navigate to the Url value provided.
	/// Otherwise, the gear icon will be excluded.
	/// </remarks>
	[Parameter]
	public string? ProfileUrl { get; set; }


	private bool HasProfileUrl => string.IsNullOrWhiteSpace(this.ProfileUrl) is false;

	private string ProfilePicStyle {
		get {
			return
				$"background-image:url({ProfilePicUrl});";
		}
	}

	private string PresenceColorStyle => this.Status switch {
		PresenceStatus.Available => "color: var(--presence-available);",
		PresenceStatus.Away => "color: var(--presence-away);",
		PresenceStatus.Busy => "color: var(--presence-busy);",
		PresenceStatus.DoNotDisturb => "color: var(--presence-dnd);",
		PresenceStatus.Offline => "color: var(--presence-offline);",
		PresenceStatus.OutOfOffice => "color: var(--presence-oof);",
		_ => "color: var(--presence-unknown);"
	};

}